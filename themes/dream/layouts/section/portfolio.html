{{ define "title" }}
{{ i18n "portfolio.title" | default "Портфолио" }}
{{ end }}

{{ define "main" }}

{{ if site.Params.portfolio }}

{{ $allPortfolioPages := where site.RegularPages "Type" "portfolio" }}

<!-- Hero секция портфолио -->
<section class="max-w-7xl mx-auto px-4 sm:px-6 py-8 sm:py-12">
  <div class="text-center max-w-3xl mx-auto">
    
    <!-- Бейдж -->
    <div class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-base-200 text-base-content/70 text-sm font-medium mb-4">
      <ion-icon name="briefcase-outline"></ion-icon>
      {{ i18n "portfolio.badge" | default "Мои работы" }}
    </div>
    
    <!-- Заголовок -->
    <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold mb-3 sm:mb-4">
      {{ i18n "portfolio.heroTitle" | default "Проекты, которыми я горжусь" }}
    </h1>
    
    <!-- Описание -->
    <p class="text-base-content/60 mb-6 max-w-2xl mx-auto">
      {{ i18n "portfolio.heroDescription" | default "Каждый проект — это уникальная история. Здесь собраны работы, в которые я вложил душу, знания и креативность." }}
    </p>
    
  </div>
</section>

<!-- Статистика -->
<section class="max-w-7xl mx-auto px-4 sm:px-6 pb-8">
  
  {{ $filters := slice }}
  {{ range $allPortfolioPages }}
    {{ with .Params.filters }}
      {{ range . }}
        {{ $filters = $filters | append . }}
      {{ end }}
    {{ end }}
  {{ end }}
  {{ $uniqueFilters := uniq $filters }}
  
  <!-- Собираем tools из всех проектов -->
  {{ $allTools := slice }}
  {{ range $allPortfolioPages }}
    {{ with .Params.tools }}
      {{ range . }}
        {{ $allTools = $allTools | append . }}
      {{ end }}
    {{ end }}
  {{ end }}
  {{ $uniqueTools := uniq $allTools }}
  
  <div class="flex flex-wrap justify-center gap-4 sm:gap-6">
    
    <div class="flex items-center gap-2 px-4 py-2 rounded-xl bg-base-200/50 border border-base-300">
      <ion-icon name="briefcase-outline" class="text-lg text-primary"></ion-icon>
      <span class="font-bold">{{ len $allPortfolioPages }}</span>
      <span class="text-sm text-base-content/60">{{ i18n "portfolio.statsProjects" | default "проектов" }}</span>
    </div>
    
    <div class="flex items-center gap-2 px-4 py-2 rounded-xl bg-base-200/50 border border-base-300">
      <ion-icon name="folder-outline" class="text-lg text-secondary"></ion-icon>
      <span class="font-bold">{{ len $uniqueFilters }}</span>
      <span class="text-sm text-base-content/60">{{ i18n "portfolio.statsCategories" | default "категорий" }}</span>
    </div>
    
    {{ if gt (len $uniqueTools) 0 }}
    <div class="flex items-center gap-2 px-4 py-2 rounded-xl bg-base-200/50 border border-base-300">
      <ion-icon name="code-slash-outline" class="text-lg text-accent"></ion-icon>
      <span class="font-bold">{{ len $uniqueTools }}+</span>
      <span class="text-sm text-base-content/60">{{ i18n "portfolio.statsTools" | default "технологий" }}</span>
    </div>
    {{ end }}
    
  </div>
</section>

<!-- Основной контент -->
<div class="px-4 sm:px-6 pb-8">
  <div class="max-w-7xl mx-auto">

    <!-- Фильтры -->
    {{ if gt (len $uniqueFilters) 0 }}
    <div class="mb-8 sm:mb-10">
      
      <!-- Мобильная версия -->
      <div class="sm:hidden">
        <div class="overflow-x-auto scrollbar-hide -mx-4 px-4">
          <div class="flex gap-2 pb-2 w-max" role="group">
            <button 
              class="filter-button flex items-center gap-1.5 px-4 py-2 rounded-full
                    bg-base-200 hover:bg-primary hover:text-primary-content
                    transition-all duration-200 whitespace-nowrap font-medium
                    data-[state=checked]:bg-primary data-[state=checked]:text-primary-content" 
              data-filter="*" 
              data-state="checked">
              <ion-icon name="apps" class="text-base"></ion-icon>
              {{ i18n "portfolio.all" | default "Все" }}
              <span class="opacity-70">({{ len $allPortfolioPages }})</span>
            </button>
            
            {{ range $filter := $uniqueFilters }}
            {{ $filterCount := 0 }}
            {{ range $allPortfolioPages }}
              {{ $pageFilters := .Params.filters }}
              {{ range $pageFilters }}
                {{ if eq . $filter }}
                  {{ $filterCount = add $filterCount 1 }}
                {{ end }}
              {{ end }}
            {{ end }}
            <button 
              class="filter-button flex items-center gap-1.5 px-4 py-2 rounded-full
                    bg-base-200 hover:bg-primary hover:text-primary-content
                    transition-all duration-200 whitespace-nowrap font-medium
                    data-[state=checked]:bg-primary data-[state=checked]:text-primary-content" 
              data-filter=".{{ $filter | urlize }}" 
              data-state="unchecked">
              {{ $filter | humanize }}
              <span class="opacity-70">({{ $filterCount }})</span>
            </button>
            {{ end }}
          </div>
        </div>
        
        <div class="flex justify-center mt-3">
          <span class="text-xs text-base-content/40 flex items-center gap-1">
            <ion-icon name="swap-horizontal"></ion-icon>
            {{ i18n "portfolio.swipeToFilter" | default "Свайпайте для фильтра" }}
          </span>
        </div>
      </div>
      
      <!-- Десктопная версия -->
      <div class="hidden sm:flex flex-wrap justify-center gap-2" role="group">
        <button 
          class="filter-button flex items-center gap-2 px-4 py-2 rounded-full
                bg-base-200 hover:bg-primary hover:text-primary-content
                transition-all duration-200 font-medium
                data-[state=checked]:bg-primary data-[state=checked]:text-primary-content" 
          data-filter="*" 
          data-state="checked">
          <ion-icon name="apps"></ion-icon>
          {{ i18n "portfolio.all" | default "Все" }}
          <span class="opacity-70">({{ len $allPortfolioPages }})</span>
        </button>
        
        {{ range $filter := $uniqueFilters }}
        {{ $filterCount := 0 }}
        {{ range $allPortfolioPages }}
          {{ $pageFilters := .Params.filters }}
          {{ range $pageFilters }}
            {{ if eq . $filter }}
              {{ $filterCount = add $filterCount 1 }}
            {{ end }}
          {{ end }}
        {{ end }}
        <button 
          class="filter-button flex items-center gap-2 px-4 py-2 rounded-full
                bg-base-200 hover:bg-primary hover:text-primary-content
                transition-all duration-200 font-medium
                data-[state=checked]:bg-primary data-[state=checked]:text-primary-content" 
          data-filter=".{{ $filter | urlize }}" 
          data-state="unchecked">
          {{ $filter | humanize }}
          <span class="opacity-70">({{ $filterCount }})</span>
        </button>
        {{ end }}
      </div>
      
    </div>
    {{ end }}

    <!-- Сетка проектов -->
    {{ if site.Params.zenMode }}
    
    <div class="dream-zen-posts max-w-[65ch] mx-auto space-y-6">
      {{ range $allPortfolioPages }}
        {{ .Render "zen-summary" }}
      {{ end }}
    </div>
    
    {{ else }}
    
    <div class="dream-grid" id="portfolio-grid">
      {{ range $allPortfolioPages }}
      <div class="w-full sm:w-1/2 lg:w-1/3 p-2 sm:p-3 dream-column {{ with .Params.filters }}{{ range . }}{{ . | urlize }} {{ end }}{{ end }}">
        
        <!-- Карточка проекта -->
        <a class="group block bg-base-100 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl 
                  border border-base-200 dark:border-base-content/10
                  transition-all duration-300 hover:-translate-y-2" 
           href="{{ .RelPermalink }}">
          
          <!-- Изображение с оверлеем -->
          <div class="relative overflow-hidden aspect-video bg-base-200">
            {{ if .Params.cover }}
              {{ with .Resources.Get .Params.cover }}
                {{ if eq .MediaType.SubType "svg" }}
                  <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
                {{ else }}
                  {{ $webp := .Resize (printf "%dx%d webp" .Width .Height) }}
                  <picture>
                    <source srcset="{{ $webp.RelPermalink }}" type="image/webp" />
                    <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
                  </picture>
                {{ end }}
              {{ else }}
                <img src="{{ .Params.cover }}" alt="{{ .Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
              {{ end }}
            {{ else if not site.Params.noDefaultSummaryCover }}
              {{ with resources.Get (printf "images/default%d.jpg" (index (seq 4 | shuffle) 0)) }}
                {{ $webp := .Resize (printf "%dx%d webp" .Width .Height) }}
                <picture>
                  <source srcset="{{ $webp.RelPermalink }}" type="image/webp" />
                  <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
                </picture>
              {{ end }}
            {{ else }}
              <!-- Заглушка если нет изображения -->
              <div class="w-full h-full flex items-center justify-center bg-base-300">
                <ion-icon name="image-outline" class="text-4xl text-base-content/20"></ion-icon>
              </div>
            {{ end }}
            
            <!-- Градиентный оверлей -->
            <div class="absolute inset-0 bg-gradient-to-t from-base-100/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            
            <!-- Статус бейдж -->
            {{ if .Params.status }}
            <div class="absolute top-3 right-3">
              {{ $statusColor := "primary" }}
              {{ $statusText := .Params.status }}
              {{ if eq .Params.status "completed" }}
                {{ $statusColor = "success" }}
                {{ $statusText = i18n "portfolio.statusCompleted" | default "Завершён" }}
              {{ else if eq .Params.status "in-progress" }}
                {{ $statusColor = "warning" }}
                {{ $statusText = i18n "portfolio.statusInProgress" | default "В работе" }}
              {{ else if eq .Params.status "archived" }}
                {{ $statusColor = "neutral" }}
                {{ $statusText = i18n "portfolio.statusArchived" | default "Архив" }}
              {{ end }}
              <span class="badge badge-{{ $statusColor }} badge-sm shadow-lg">{{ $statusText }}</span>
            </div>
            {{ end }}
          </div>

          <!-- Контент карточки -->
          <div class="p-5 space-y-3">
            
            <!-- Категории -->
            {{ with .Params.filters }}
            <div class="flex flex-wrap gap-1.5">
              {{ range first 3 . }}
              <span class="badge badge-ghost badge-sm">{{ . | humanize }}</span>
              {{ end }}
              {{ if gt (len .) 3 }}
              <span class="badge badge-ghost badge-sm">+{{ sub (len .) 3 }}</span>
              {{ end }}
            </div>
            {{ end }}
            
            <!-- Заголовок -->
            <h2 class="text-xl font-bold line-clamp-2 group-hover:text-primary transition-colors">
              {{ .Title }}
            </h2>

            <!-- Описание -->
            {{ with .Summary }}
            <p class="text-sm text-base-content/70 line-clamp-2">
              {{ . | plainify | truncate 100 }}
            </p>
            {{ end }}
            
            <!-- Технологии (tools) -->
            {{ with .Params.tools }}
            <div class="flex flex-wrap gap-1.5">
              {{ range first 4 . }}
              <span class="inline-flex items-center gap-1 px-2 py-1 text-xs bg-base-200 rounded-md">
                <ion-icon name="code-slash-outline" class="text-xs"></ion-icon>
                {{ . }}
              </span>
              {{ end }}
              {{ if gt (len .) 4 }}
              <span class="inline-flex items-center px-2 py-1 text-xs bg-base-200 rounded-md text-base-content/60">
                +{{ sub (len .) 4 }}
              </span>
              {{ end }}
            </div>
            {{ end }}

            <!-- Футер карточки -->
            <div class="flex items-center justify-between pt-3 border-t border-base-200">
              
              <!-- Дата -->
              <div class="flex items-center gap-1.5 text-xs text-base-content/60">
                <ion-icon name="calendar-outline" class="text-sm"></ion-icon>
                {{ if site.Params.Experimental.jsDate }}
                  <span data-format="luxon">{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}</span>
                {{ else }}
                  {{ .Date | time.Format ":date_medium" }}
                {{ end }}
              </div>

              <!-- Время чтения -->
              <div class="flex items-center gap-1.5 text-xs text-base-content/60">
                <ion-icon name="time-outline" class="text-sm"></ion-icon>
                <span>{{ .ReadingTime }} {{ i18n "minuteRead" .ReadingTime | default "мин" }}</span>
              </div>
            </div>
            
            <!-- Кнопка действия -->
            <div class="pt-2">
              <span class="inline-flex items-center gap-2 text-sm font-medium text-primary group-hover:gap-3 transition-all">
                {{ i18n "portfolio.viewProject" | default "Смотреть проект" }}
                <ion-icon name="arrow-forward" class="text-base"></ion-icon>
              </span>
            </div>
          </div>
        </a>
        
      </div>
      {{ end }}
    </div>
    
    <!-- Пустое состояние -->
    <div id="no-results" class="hidden text-center py-12">
      <ion-icon name="search-outline" class="text-4xl text-base-content/30 mb-3"></ion-icon>
      <h3 class="text-lg font-bold mb-2">{{ i18n "portfolio.noProjects" | default "Проектов не найдено" }}</h3>
      <p class="text-base-content/60 text-sm mb-4">{{ i18n "portfolio.tryOtherFilter" | default "Попробуйте другую категорию" }}</p>
      <button onclick="document.querySelector('[data-filter=\'*\']').click()" class="btn btn-sm btn-primary">
        {{ i18n "portfolio.resetFilter" | default "Показать все" }}
      </button>
    </div>
    
    {{ end }}

  </div>
</div>

<!-- Секция "Как я работаю" -->
<section class="py-10 sm:py-12">
  <div class="max-w-4xl mx-auto px-4 sm:px-6">
    
    <div class="text-center mb-8">
      <h2 class="text-xl sm:text-2xl font-bold mb-2">
        {{ i18n "portfolio.processTitle" | default "Как я работаю" }}
      </h2>
      <p class="text-sm text-base-content/60">
        {{ i18n "portfolio.processDescription" | default "Простой и понятный процесс работы над проектом" }}
      </p>
    </div>
    
    <div class="space-y-3">
      
      <!-- Шаг 1 -->
      <div class="group">
        <div class="p-3 sm:p-4 rounded-lg sm:rounded-xl
                    bg-base-200/50 dark:bg-base-200/10
                    border border-transparent
                    hover:border-primary/30 hover:bg-base-200 dark:hover:bg-base-200/20
                    hover:shadow-sm
                    transition-all duration-200">
          <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
            
            <div class="flex items-center gap-3 shrink-0">
              <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-primary/10 text-primary font-bold text-sm">
                1
              </span>
              <ion-icon name="chatbubbles-outline" class="text-xl text-primary sm:hidden"></ion-icon>
            </div>
            
            <ion-icon name="chatbubbles-outline" class="hidden sm:block text-xl text-base-content/40 group-hover:text-primary transition-colors"></ion-icon>
            
            <div class="flex-1">
              <h3 class="font-medium group-hover:text-primary transition-colors">
                {{ i18n "portfolio.step1Title" | default "Обсуждение" }}
              </h3>
              <p class="text-sm text-base-content/60 mt-0.5">
                {{ i18n "portfolio.step1Description" | default "Знакомство с проектом, определение целей и требований" }}
              </p>
            </div>
            
            <ion-icon name="arrow-forward" class="hidden sm:block text-base-content/30 group-hover:text-primary group-hover:translate-x-1 transition-all shrink-0"></ion-icon>
          </div>
        </div>
      </div>
      
      <!-- Шаг 2 -->
      <div class="group">
        <div class="p-3 sm:p-4 rounded-lg sm:rounded-xl
                    bg-base-200/50 dark:bg-base-200/10
                    border border-transparent
                    hover:border-primary/30 hover:bg-base-200 dark:hover:bg-base-200/20
                    hover:shadow-sm
                    transition-all duration-200">
          <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
            
            <div class="flex items-center gap-3 shrink-0">
              <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-secondary/10 text-secondary font-bold text-sm">
                2
              </span>
              <ion-icon name="bulb-outline" class="text-xl text-secondary sm:hidden"></ion-icon>
            </div>
            
            <ion-icon name="bulb-outline" class="hidden sm:block text-xl text-base-content/40 group-hover:text-secondary transition-colors"></ion-icon>
            
            <div class="flex-1">
              <h3 class="font-medium group-hover:text-primary transition-colors">
                {{ i18n "portfolio.step2Title" | default "Планирование" }}
              </h3>
              <p class="text-sm text-base-content/60 mt-0.5">
                {{ i18n "portfolio.step2Description" | default "Разработка стратегии, дизайна и технической архитектуры" }}
              </p>
            </div>
            
            <ion-icon name="arrow-forward" class="hidden sm:block text-base-content/30 group-hover:text-primary group-hover:translate-x-1 transition-all shrink-0"></ion-icon>
          </div>
        </div>
      </div>
      
      <!-- Шаг 3 -->
      <div class="group">
        <div class="p-3 sm:p-4 rounded-lg sm:rounded-xl
                    bg-base-200/50 dark:bg-base-200/10
                    border border-transparent
                    hover:border-primary/30 hover:bg-base-200 dark:hover:bg-base-200/20
                    hover:shadow-sm
                    transition-all duration-200">
          <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
            
            <div class="flex items-center gap-3 shrink-0">
              <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-accent/10 text-accent font-bold text-sm">
                3
              </span>
              <ion-icon name="code-slash-outline" class="text-xl text-accent sm:hidden"></ion-icon>
            </div>
            
            <ion-icon name="code-slash-outline" class="hidden sm:block text-xl text-base-content/40 group-hover:text-accent transition-colors"></ion-icon>
            
            <div class="flex-1">
              <h3 class="font-medium group-hover:text-primary transition-colors">
                {{ i18n "portfolio.step3Title" | default "Разработка" }}
              </h3>
              <p class="text-sm text-base-content/60 mt-0.5">
                {{ i18n "portfolio.step3Description" | default "Создание продукта с регулярными демонстрациями прогресса" }}
              </p>
            </div>
            
            <ion-icon name="arrow-forward" class="hidden sm:block text-base-content/30 group-hover:text-primary group-hover:translate-x-1 transition-all shrink-0"></ion-icon>
          </div>
        </div>
      </div>
      
      <!-- Шаг 4 -->
      <div class="group">
        <div class="p-3 sm:p-4 rounded-lg sm:rounded-xl
                    bg-base-200/50 dark:bg-base-200/10
                    border border-transparent
                    hover:border-primary/30 hover:bg-base-200 dark:hover:bg-base-200/20
                    hover:shadow-sm
                    transition-all duration-200">
          <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
            
            <div class="flex items-center gap-3 shrink-0">
              <span class="flex items-center justify-center w-8 h-8 rounded-lg bg-success/10 text-success font-bold text-sm">
                4
              </span>
              <ion-icon name="rocket-outline" class="text-xl text-success sm:hidden"></ion-icon>
            </div>
            
            <ion-icon name="rocket-outline" class="hidden sm:block text-xl text-base-content/40 group-hover:text-success transition-colors"></ion-icon>
            
            <div class="flex-1">
              <h3 class="font-medium group-hover:text-primary transition-colors">
                {{ i18n "portfolio.step4Title" | default "Запуск" }}
              </h3>
              <p class="text-sm text-base-content/60 mt-0.5">
                {{ i18n "portfolio.step4Description" | default "Публикация проекта и поддержка после запуска" }}
              </p>
            </div>
            
            <ion-icon name="checkmark-circle" class="hidden sm:block text-success shrink-0"></ion-icon>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</section>

<!-- Технологии -->
{{ if gt (len $uniqueTools) 0 }}
<section class="py-10 sm:py-12 border-t border-base-300">
  <div class="max-w-4xl mx-auto px-4 sm:px-6">
    
    <div class="text-center mb-6">
      <h2 class="text-xl sm:text-2xl font-bold mb-2">
        {{ i18n "portfolio.techTitle" | default "Технологии" }}
      </h2>
      <p class="text-sm text-base-content/60">
        {{ i18n "portfolio.techDescription" | default "Инструменты, которые я использую в работе" }}
      </p>
    </div>

    <div class="flex flex-wrap justify-center gap-2">
      {{ range $uniqueTools }}
      <span class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-base-200 hover:bg-primary hover:text-primary-content transition-all duration-300 cursor-default">
        {{ . }}
      </span>
      {{ end }}
    </div>
    
  </div>
</section>
{{ end }}

<!-- FAQ секция -->
<section class="py-12 sm:py-16">
  <div class="max-w-3xl mx-auto px-4 sm:px-6">
    
    <div class="text-center mb-10 sm:mb-12">
      <h2 class="text-xl sm:text-2xl font-bold mb-2">
        {{ i18n "portfolio.faqTitle" | default "Часто задаваемые вопросы" }}
      </h2>
      <p class="text-sm text-base-content/60">
        {{ i18n "portfolio.faqDescription" | default "Ответы на популярные вопросы о сотрудничестве" }}
      </p>
    </div>

    <div class="space-y-4">
      
      <!-- FAQ 1 -->
      <div class="collapse collapse-plus bg-base-100 shadow-lg border border-base-200 rounded-2xl">
        <input type="radio" name="faq-accordion" checked="checked" /> 
        <div class="collapse-title text-lg font-medium">
          {{ i18n "portfolio.faq1Question" | default "Сколько стоит разработка проекта?" }}
        </div>
        <div class="collapse-content">
          <p class="text-base-content/70">
            {{ i18n "portfolio.faq1Answer" | default "Стоимость зависит от сложности и объема работ. После обсуждения требований я предоставлю детальную оценку. Первая консультация — бесплатно." }}
          </p>
        </div>
      </div>
      
      <!-- FAQ 2 -->
      <div class="collapse collapse-plus bg-base-100 shadow-lg border border-base-200 rounded-2xl">
        <input type="radio" name="faq-accordion" /> 
        <div class="collapse-title text-lg font-medium">
          {{ i18n "portfolio.faq2Question" | default "Сколько времени занимает разработка?" }}
        </div>
        <div class="collapse-content">
          <p class="text-base-content/70">
            {{ i18n "portfolio.faq2Answer" | default "Сроки варьируются от 2-4 недель для лендингов до нескольких месяцев для сложных проектов. Точные сроки обсуждаются индивидуально." }}
          </p>
        </div>
      </div>
      
      <!-- FAQ 3 -->
      <div class="collapse collapse-plus bg-base-100 shadow-lg border border-base-200 rounded-2xl">
        <input type="radio" name="faq-accordion" /> 
        <div class="collapse-title text-lg font-medium">
          {{ i18n "portfolio.faq3Question" | default "Какие гарантии вы предоставляете?" }}
        </div>
        <div class="collapse-content">
          <p class="text-base-content/70">
            {{ i18n "portfolio.faq3Answer" | default "Предоставляю гарантийную поддержку после запуска проекта, исправление багов и помощь в случае вопросов. Условия обсуждаются в договоре." }}
          </p>
        </div>
      </div>
      
      <!-- FAQ 4 -->
      <div class="collapse collapse-plus bg-base-100 shadow-lg border border-base-200 rounded-2xl">
        <input type="radio" name="faq-accordion" /> 
        <div class="collapse-title text-lg font-medium">
          {{ i18n "portfolio.faq4Question" | default "Работаете ли вы с зарубежными клиентами?" }}
        </div>
        <div class="collapse-content">
          <p class="text-base-content/70">
            {{ i18n "portfolio.faq4Answer" | default "Да, работаю с клиентами из любых стран. Общение возможно на русском и английском языках через удобные мессенджеры." }}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CTA секция -->
<section class="py-10 sm:py-12">
  <div class="max-w-2xl mx-auto px-4 sm:px-6">
    
    <div class="p-6 sm:p-8 rounded-2xl bg-base-200/50 dark:bg-base-200/10 border border-base-300 text-center">
      
      <div class="inline-flex items-center justify-center w-14 h-14 rounded-xl bg-primary/10 text-primary mb-4">
        <ion-icon name="chatbubble-ellipses-outline" class="text-2xl"></ion-icon>
      </div>
      
      <h2 class="text-xl sm:text-2xl font-bold mb-2">
        {{ i18n "portfolio.ctaTitle" | default "Есть интересный проект?" }}
      </h2>
      
      <p class="text-base-content/60 mb-6 max-w-md mx-auto">
        {{ i18n "portfolio.ctaDescription" | default "Давайте обсудим вашу идею. Первая консультация — бесплатно." }}
      </p>
      
      <div class="flex flex-wrap justify-center gap-3">
        {{/* Определяем ссылку на контакты */}}
        {{ $contactLink := "https://t.me/cyber_way" }}
        {{ $useTelegram := true }}
        {{ $contactText := "Telegram" }}
        
        {{/* Проверяем наличие страницы контактов */}}
        {{ with site.GetPage "/contact" }}
          {{ $contactLink = .RelPermalink }}
          {{ $useTelegram = false }}
          {{ $contactText = i18n "portfolio.ctaButton" | default "Написать мне" }}
        {{ else }}
          {{/* Проверяем настройки сайта */}}
          {{ with site.Params.contact }}
            {{ $contactLink = . }}
            {{ if strings.Contains . "t.me" }}
              {{ $useTelegram = true }}
              {{ $contactText = "Telegram" }}
            {{ else if strings.Contains . "mailto:" }}
              {{ $useTelegram = false }}
              {{ $contactText = i18n "portfolio.ctaEmail" | default "Email" }}
            {{ else }}
              {{ $useTelegram = false }}
              {{ $contactText = i18n "portfolio.ctaButton" | default "Написать мне" }}
            {{ end }}
          {{ end }}
        {{ end }}
        
        <a href="{{ $contactLink }}" class="btn btn-primary gap-2" {{ if not (hasPrefix $contactLink "/") }}target="_blank" rel="noopener"{{ end }}>
          {{ if $useTelegram }}
            <!-- Telegram SVG иконка -->
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
              <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
            </svg>
          {{ else }}
            <ion-icon name="send-outline"></ion-icon>
          {{ end }}
          {{ $contactText }}
        </a>
      </div>
      
    </div>
    
  </div>
</section>

<!-- Isotope JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const grid = document.querySelector(".dream-grid");
  if (!grid) return;
  
  const noResults = document.getElementById("no-results");
  
  const iso = new Isotope(grid, {
    itemSelector: ".dream-column",
    layoutMode: "fitRows",
    transitionDuration: '0.4s',
    stagger: 30
  });

  const filterButtons = document.querySelectorAll(".filter-button");
  
  filterButtons.forEach((button) => {
    button.addEventListener("click", function () {
      const filterValue = button.getAttribute("data-filter");
      
      iso.arrange({ filter: filterValue });

      filterButtons.forEach((btn) => {
        btn.setAttribute("data-state", "unchecked");
      });
      button.setAttribute("data-state", "checked");
      
      if (window.innerWidth < 640) {
        setTimeout(() => {
          grid.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
      }
    });
  });
  
  iso.on('arrangeComplete', function(filteredItems) {
    if (noResults) {
      if (filteredItems.length === 0) {
        noResults.classList.remove('hidden');
        grid.classList.add('hidden');
      } else {
        noResults.classList.add('hidden');
        grid.classList.remove('hidden');
      }
    }
  });
});
</script>

{{ else }}

<!-- Портфолио отключено -->
<div class="min-h-[60vh] flex items-center justify-center px-4 sm:px-6">
  <div class="text-center py-12">
    <ion-icon name="briefcase-outline" class="text-5xl text-base-content/30 mb-4"></ion-icon>
    <h1 class="text-xl font-bold mb-2">{{ i18n "portfolio.title" | default "Портфолио" }}</h1>
    <p class="text-base-content/60 mb-6">{{ i18n "portfolio.disabled" | default "Раздел скоро появится" }}</p>
    <a href="{{ "/" | relURL }}" class="btn btn-primary btn-sm">
      {{ i18n "backToHome" | default "На главную" }}
    </a>
  </div>
</div>

{{ end }}

{{ end }}

{{ define "js" }}
{{ if site.Params.Experimental.jsDate }}
  {{ partial "luxon.html" . }}
{{ end }}
{{ end }}