{{ define "title" }}
{{ i18n "portfolio.title" | default "–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ" }}
{{ end }}

{{ define "main" }}

{{ if site.Params.portfolio }}

{{ $allPortfolioPages := where site.RegularPages "Type" "portfolio" }}

<!-- –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ -->
{{ $filters := slice }}
{{ range $allPortfolioPages }}
  {{ with .Params.filters }}
    {{ range . }}
      {{ $filters = $filters | append . }}
    {{ end }}
  {{ end }}
{{ end }}
{{ $uniqueFilters := uniq $filters }}

{{ $allTools := slice }}
{{ range $allPortfolioPages }}
  {{ with .Params.tools }}
    {{ range . }}
      {{ $allTools = $allTools | append . }}
    {{ end }}
  {{ end }}
{{ end }}
{{ $uniqueTools := uniq $allTools }}

{{ $completedCount := 0 }}
{{ $inProgressCount := 0 }}
{{ range $allPortfolioPages }}
  {{ if eq .Params.status "completed" }}
    {{ $completedCount = add $completedCount 1 }}
  {{ else if eq .Params.status "in-progress" }}
    {{ $inProgressCount = add $inProgressCount 1 }}
  {{ end }}
{{ end }}

<!-- Hero —Å–µ–∫—Ü–∏—è -->
<section class="relative overflow-hidden">
  
  <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
  <div class="absolute inset-0 -z-10 overflow-hidden">
    <div class="absolute top-20 left-10 w-72 h-72 bg-primary/8 rounded-full blur-3xl"></div>
    <div class="absolute top-40 right-20 w-96 h-96 bg-secondary/6 rounded-full blur-3xl"></div>
    <div class="absolute -bottom-20 left-1/3 w-80 h-80 bg-accent/5 rounded-full blur-3xl"></div>
    
    <!-- –°–µ—Ç–∫–∞ –Ω–∞ —Ñ–æ–Ω–µ -->
    <div class="absolute inset-0 opacity-[0.015] dark:opacity-[0.03]" 
         style="background-image: linear-gradient(currentColor 1px, transparent 1px), linear-gradient(90deg, currentColor 1px, transparent 1px); background-size: 60px 60px;"></div>
  </div>
  
  <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –ø–æ –±–æ–∫–∞–º -->
  <div class="absolute left-0 top-0 bottom-0 w-8 sm:w-16 md:w-24 lg:w-32 xl:w-48 
              bg-gradient-to-r from-base-100 via-base-100/80 to-transparent 
              z-0 pointer-events-none"></div>
  <div class="absolute right-0 top-0 bottom-0 w-8 sm:w-16 md:w-24 lg:w-32 xl:w-48 
              bg-gradient-to-l from-base-100 via-base-100/80 to-transparent 
              z-0 pointer-events-none"></div>
  
  <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 pt-8 sm:pt-16 pb-12 sm:pb-20">
    
    <div class="flex flex-col lg:flex-row items-center gap-10 lg:gap-20">
      
      <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ -->
      <div class="flex-1 text-center lg:text-left">
        
        <!-- –õ–µ–π–±–ª -->
        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-2xl 
                    bg-base-100 shadow-sm border border-base-200 dark:border-base-content/10 mb-6">
          <span class="relative flex h-2.5 w-2.5">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-success opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-success"></span>
          </span>
          <span class="text-sm font-medium text-base-content/70">
            {{ i18n "portfolio.available" | default "–û—Ç–∫—Ä—ã—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤" }}
          </span>
        </div>
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-black mb-6 leading-[1.1] tracking-tight">
          {{ i18n "portfolio.heroTitle1" | default "–ü—Ä–æ–µ–∫—Ç—ã," }}
          <span class="relative">
            <span class="relative z-10 bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent">
              {{ i18n "portfolio.heroTitle2" | default "–∫–æ—Ç–æ—Ä—ã–º–∏ –≥–æ—Ä–∂—É—Å—å" }}
            </span>
            <svg class="absolute -bottom-2 left-0 w-full h-3 text-primary/20" viewBox="0 0 200 12" preserveAspectRatio="none">
              <path d="M0,10 Q50,0 100,10 T200,10" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>
            </svg>
          </span>
        </h1>
        
        <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
        <p class="text-lg sm:text-xl text-base-content/60 mb-8 max-w-xl mx-auto lg:mx-0 leading-relaxed">
          {{ i18n "portfolio.heroDescription" | default "–ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è. –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã —Ä–∞–±–æ—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã–µ —è –≤–ª–æ–∂–∏–ª –¥—É—à—É, –∑–Ω–∞–Ω–∏—è –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å." }}
        </p>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞-–ø–∏–ª—é–ª–∏ -->
        <div class="flex flex-wrap justify-center lg:justify-start gap-3">
          <div class="flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 text-primary text-sm font-medium">
            <ion-icon name="briefcase"></ion-icon>
            <span>{{ len $allPortfolioPages }} {{ i18n "portfolio.projects" | default "–ø—Ä–æ–µ–∫—Ç–æ–≤" }}</span>
          </div>
          {{ if gt $completedCount 0 }}
          <div class="flex items-center gap-2 px-4 py-2 rounded-full bg-success/10 text-success text-sm font-medium">
            <ion-icon name="checkmark-circle"></ion-icon>
            <span>{{ $completedCount }} {{ i18n "portfolio.completed" | default "–∑–∞–≤–µ—Ä—à–µ–Ω–æ" }}</span>
          </div>
          {{ end }}
          {{ if gt (len $uniqueTools) 0 }}
          <div class="flex items-center gap-2 px-4 py-2 rounded-full bg-secondary/10 text-secondary text-sm font-medium">
            <ion-icon name="code-slash"></ion-icon>
            <span>{{ len $uniqueTools }}+ {{ i18n "portfolio.technologies" | default "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π" }}</span>
          </div>
          {{ end }}
        </div>
        
      </div>
      
      <!-- –í–∏–∑—É–∞–ª—å–Ω—ã–π –±–ª–æ–∫ -->
      <div class="flex-shrink-0 w-full max-w-sm lg:max-w-md">
        <div class="relative">
          
          <!-- –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ —Ñ–æ–Ω–µ -->
          <div class="absolute -top-4 -left-4 w-full h-full rounded-3xl bg-primary/5 rotate-3"></div>
          <div class="absolute -top-2 -left-2 w-full h-full rounded-3xl bg-secondary/5 rotate-1"></div>
          
          <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –ø—Ä–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
          <div class="relative bg-base-100 rounded-3xl p-6 sm:p-8 shadow-2xl border border-base-200 dark:border-base-content/10">
            
            <!-- –ú–∏–Ω–∏-–ø—Ä–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
            <div class="grid grid-cols-2 gap-3 mb-6">
              {{ range first 4 $allPortfolioPages }}
              <div class="relative aspect-video rounded-xl overflow-hidden bg-base-200 group cursor-pointer"
                   title="{{ .Title }}">
                {{ if .Params.cover }}
                  {{ with .Resources.Get .Params.cover }}
                    <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" 
                         class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300" />
                  {{ else }}
                    <img src="{{ $.Params.cover }}" alt="{{ $.Title }}" 
                         class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300" />
                  {{ end }}
                {{ else }}
                  <div class="w-full h-full flex items-center justify-center">
                    <ion-icon name="image-outline" class="text-2xl text-base-content/20"></ion-icon>
                  </div>
                {{ end }}
                <div class="absolute inset-0 bg-gradient-to-t from-base-100/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
              </div>
              {{ end }}
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="grid grid-cols-3 gap-3">
              <div class="text-center p-3 rounded-xl bg-base-200/50">
                <div class="text-2xl font-black text-primary mb-0.5">{{ len $allPortfolioPages }}</div>
                <div class="text-[10px] text-base-content/60 uppercase tracking-wide">{{ i18n "portfolio.statsProjects" | default "–ü—Ä–æ–µ–∫—Ç–æ–≤" }}</div>
              </div>
              <div class="text-center p-3 rounded-xl bg-base-200/50">
                <div class="text-2xl font-black text-secondary mb-0.5">{{ len $uniqueFilters }}</div>
                <div class="text-[10px] text-base-content/60 uppercase tracking-wide">{{ i18n "portfolio.statsCategories" | default "–ö–∞—Ç–µ–≥–æ—Ä–∏–π" }}</div>
              </div>
              <div class="text-center p-3 rounded-xl bg-base-200/50">
                <div class="text-2xl font-black text-accent mb-0.5">{{ len $uniqueTools }}</div>
                <div class="text-[10px] text-base-content/60 uppercase tracking-wide">{{ i18n "portfolio.statsTools" | default "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π" }}</div>
              </div>
            </div>
            
          </div>
        </div>
      </div>
      
    </div>
    
  </div>
</section>

<!-- –§–∏–ª—å—Ç—Ä—ã -->
{{ if gt (len $uniqueFilters) 0 }}
<section class="relative bg-base-100/50 backdrop-blur-sm overflow-hidden">
  
  <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –ø–æ –±–æ–∫–∞–º -->
  <div class="absolute left-0 top-0 bottom-0 w-8 sm:w-16 md:w-24 lg:w-32 xl:w-48 
              bg-gradient-to-r from-base-100 via-base-100/80 to-transparent 
              z-20 pointer-events-none"></div>
  <div class="absolute right-0 top-0 bottom-0 w-8 sm:w-16 md:w-24 lg:w-32 xl:w-48 
              bg-gradient-to-l from-base-100 via-base-100/80 to-transparent 
              z-20 pointer-events-none"></div>
  
  <!-- –ó–∞—Ç–µ–º–Ω—ë–Ω–Ω—ã–µ –±–æ—Ä–¥–µ—Ä—ã —Å–≤–µ—Ä—Ö—É –∏ —Å–Ω–∏–∑—É -->
  <div class="absolute left-0 right-0 top-0 h-px">
    <div class="absolute inset-0 bg-base-300 dark:bg-base-content/10"></div>
    <div class="absolute left-0 top-0 bottom-0 w-16 sm:w-24 md:w-32 lg:w-48 xl:w-64 bg-gradient-to-r from-base-100 to-transparent"></div>
    <div class="absolute right-0 top-0 bottom-0 w-16 sm:w-24 md:w-32 lg:w-48 xl:w-64 bg-gradient-to-l from-base-100 to-transparent"></div>
  </div>
  <div class="absolute left-0 right-0 bottom-0 h-px">
    <div class="absolute inset-0 bg-base-300 dark:bg-base-content/10"></div>
    <div class="absolute left-0 top-0 bottom-0 w-16 sm:w-24 md:w-32 lg:w-48 xl:w-64 bg-gradient-to-r from-base-100 to-transparent"></div>
    <div class="absolute right-0 top-0 bottom-0 w-16 sm:w-24 md:w-32 lg:w-48 xl:w-64 bg-gradient-to-l from-base-100 to-transparent"></div>
  </div>
  
  <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6">
    
    <div class="py-5">
      
      <div class="flex items-center gap-4">
        
        <!-- –õ–µ–π–±–ª -->
        <div class="hidden sm:flex items-center gap-2 text-sm text-base-content/50 font-medium shrink-0">
          <ion-icon name="filter-outline"></ion-icon>
          {{ i18n "portfolio.filterBy" | default "–§–∏–ª—å—Ç—Ä:" }}
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –≤–ª–µ–≤–æ -->
        <button id="scroll-left" class="hidden sm:flex shrink-0 w-8 h-8 items-center justify-center rounded-lg
                                        bg-base-200 hover:bg-base-300 text-base-content/60 transition-all
                                        disabled:opacity-30 disabled:cursor-not-allowed" disabled>
          <ion-icon name="chevron-back"></ion-icon>
        </button>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–±–æ–≤ -->
        <div id="filters-container" class="flex-1 overflow-hidden relative">
          
          <!-- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Å–∫—Ä–æ–ª–ª–∞ -->
          <div id="fade-left" class="absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-base-100 to-transparent z-10 pointer-events-none opacity-0 transition-opacity"></div>
          <div id="fade-right" class="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-base-100 to-transparent z-10 pointer-events-none opacity-0 transition-opacity"></div>
          
          <!-- –°–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º—ã–µ —Ç–∞–±—ã -->
          <div id="filters-scroll" class="flex items-center gap-2 overflow-x-auto scrollbar-hide scroll-smooth py-1">
            
            <!-- –í—Å–µ -->
            <button 
              class="portfolio-filter-btn shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium 
                     transition-all duration-200 text-sm whitespace-nowrap
                     bg-base-200 hover:bg-primary hover:text-primary-content
                     data-[state=checked]:bg-primary data-[state=checked]:text-primary-content data-[state=checked]:shadow-md data-[state=checked]:shadow-primary/25" 
              data-filter="*"
              data-state="checked">
              <ion-icon name="apps-outline"></ion-icon>
              <span>{{ i18n "portfolio.all" | default "–í—Å–µ" }}</span>
              <span class="inline-flex items-center justify-center min-w-[1.25rem] h-5 px-1 
                          rounded text-xs font-bold opacity-70">
                {{ len $allPortfolioPages }}
              </span>
            </button>
            
            {{ range $index, $filter := $uniqueFilters }}
            {{ $count := 0 }}
            {{ $icon := "folder-outline" }}
            {{ range $allPortfolioPages }}
              {{ $pageFilters := .Params.filters }}
              {{ range $pageFilters }}
                {{ if eq . $filter }}
                  {{ $count = add $count 1 }}
                {{ end }}
              {{ end }}
            {{ end }}
            
            {{ if eq $filter "web" }}{{ $icon = "globe-outline" }}
            {{ else if eq $filter "mobile" }}{{ $icon = "phone-portrait-outline" }}
            {{ else if eq $filter "design" }}{{ $icon = "color-palette-outline" }}
            {{ else if eq $filter "branding" }}{{ $icon = "brush-outline" }}
            {{ else if eq $filter "ecommerce" }}{{ $icon = "cart-outline" }}
            {{ else if eq $filter "app" }}{{ $icon = "apps-outline" }}
            {{ else if eq $filter "landing" }}{{ $icon = "document-outline" }}
            {{ else if eq $filter "corporate" }}{{ $icon = "business-outline" }}
            {{ end }}
            
            <button 
              class="portfolio-filter-btn shrink-0 flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium 
                     transition-all duration-200 text-sm whitespace-nowrap
                     bg-base-200 hover:bg-primary hover:text-primary-content
                     data-[state=checked]:bg-primary data-[state=checked]:text-primary-content data-[state=checked]:shadow-md data-[state=checked]:shadow-primary/25" 
              data-filter=".filter-{{ $index }}"
              data-state="unchecked">
              <ion-icon name="{{ $icon }}"></ion-icon>
              <span>{{ $filter | humanize }}</span>
              <span class="inline-flex items-center justify-center min-w-[1.25rem] h-5 px-1 
                          rounded text-xs font-bold opacity-70">
                {{ $count }}
              </span>
            </button>
            {{ end }}
            
          </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –≤–ø—Ä–∞–≤–æ -->
        <button id="scroll-right" class="hidden sm:flex shrink-0 w-8 h-8 items-center justify-center rounded-lg
                                         bg-base-200 hover:bg-base-300 text-base-content/60 transition-all
                                         disabled:opacity-30 disabled:cursor-not-allowed">
          <ion-icon name="chevron-forward"></ion-icon>
        </button>
        
      </div>
      
    </div>
    
  </div>
</section>
{{ end }}

<!-- –°–µ—Ç–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
<section class="py-10 sm:py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6">
    
    {{ if site.Params.zenMode }}
    
    <div class="dream-zen-posts max-w-[65ch] mx-auto space-y-6">
      {{ range $allPortfolioPages }}
        {{ .Render "zen-summary" }}
      {{ end }}
    </div>
    
    {{ else }}
    
    <div class="portfolio-grid" id="portfolio-grid">
      {{ range $index, $page := $allPortfolioPages }}
      
      <!-- –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
      {{ $filterClasses := "" }}
      {{ $pageFilters := .Params.filters }}
      {{ range $fi, $filter := $uniqueFilters }}
        {{ range $pageFilters }}
          {{ if eq . $filter }}
            {{ $filterClasses = printf "%s filter-%d" $filterClasses $fi }}
          {{ end }}
        {{ end }}
      {{ end }}
      
      <div class="w-full sm:w-1/2 lg:w-1/3 p-2 sm:p-3 portfolio-item {{ $filterClasses }}">
        
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ -->
        <a class="group block h-full bg-base-100 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl 
                  border border-base-200 dark:border-base-content/10
                  transition-all duration-300 hover:-translate-y-2" 
           href="{{ .RelPermalink }}">
          
          <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –æ–≤–µ—Ä–ª–µ–µ–º -->
          <div class="relative overflow-hidden aspect-video bg-base-200">
            {{ if .Params.cover }}
              {{ with .Resources.Get .Params.cover }}
                {{ if eq .MediaType.SubType "svg" }}
                  <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
                {{ else }}
                  {{ $webp := .Resize (printf "%dx%d webp" .Width .Height) }}
                  <picture>
                    <source srcset="{{ $webp.RelPermalink }}" type="image/webp" />
                    <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
                  </picture>
                {{ end }}
              {{ else }}
                <img src="{{ .Params.cover }}" alt="{{ .Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
              {{ end }}
            {{ else if not site.Params.noDefaultSummaryCover }}
              {{ with resources.Get (printf "images/default%d.jpg" (index (seq 4 | shuffle) 0)) }}
                {{ $webp := .Resize (printf "%dx%d webp" .Width .Height) }}
                <picture>
                  <source srcset="{{ $webp.RelPermalink }}" type="image/webp" />
                  <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" />
                </picture>
              {{ end }}
            {{ else }}
              <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-base-200 to-base-300">
                <ion-icon name="briefcase-outline" class="text-4xl text-base-content/20"></ion-icon>
              </div>
            {{ end }}
            
            <!-- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π -->
            <div class="absolute inset-0 bg-gradient-to-t from-base-100/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            
            <!-- –°—Ç–∞—Ç—É—Å –±–µ–π–¥–∂ -->
            {{ with .Params.status }}
            <div class="absolute top-3 left-3">
              {{ if eq . "completed" }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-success/20 text-success backdrop-blur-md border border-success/30 shadow-sm">
                  <ion-icon name="checkmark-circle-outline" class="text-sm"></ion-icon>
                  {{ i18n "portfolio.statusCompleted" | default "–ó–∞–≤–µ—Ä—à—ë–Ω" }}
                </span>
              {{ else if eq . "in-progress" }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-warning/20 text-warning backdrop-blur-md border border-warning/30 shadow-sm">
                  <ion-icon name="hourglass-outline" class="text-sm"></ion-icon>
                  {{ i18n "portfolio.statusInProgress" | default "–í —Ä–∞–±–æ—Ç–µ" }}
                </span>
              {{ else if eq . "archived" }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-base-content/10 text-base-content/70 backdrop-blur-md border border-base-content/20 shadow-sm">
                  <ion-icon name="archive-outline" class="text-sm"></ion-icon>
                  {{ i18n "portfolio.statusArchived" | default "–ê—Ä—Ö–∏–≤" }}
                </span>
              {{ else if eq . "planned" }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-info/20 text-info backdrop-blur-md border border-info/30 shadow-sm">
                  <ion-icon name="calendar-outline" class="text-sm"></ion-icon>
                  {{ i18n "portfolio.statusPlanned" | default "–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è" }}
                </span>
              {{ else if eq . "paused" }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-error/20 text-error backdrop-blur-md border border-error/30 shadow-sm">
                  <ion-icon name="pause-circle-outline" class="text-sm"></ion-icon>
                  {{ i18n "portfolio.statusPaused" | default "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" }}
                </span>
              {{ else }}
                <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium 
                            bg-primary/20 text-primary backdrop-blur-md border border-primary/30 shadow-sm">
                  <ion-icon name="ellipse-outline" class="text-sm"></ion-icon>
                  {{ . }}
                </span>
              {{ end }}
            </div>
            {{ end }}
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
            {{ with .Params.relatedProjects }}
            {{ $relatedCount := len . }}
            {{ if gt $relatedCount 0 }}
            <div class="absolute top-3 right-3">
              <span class="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-base-100/90 text-base-content shadow-lg backdrop-blur-sm" title="{{ i18n "portfolio.relatedProjects" | default "–°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã" }}: {{ $relatedCount }}">
                <ion-icon name="git-branch-outline" class="text-sm"></ion-icon>
                {{ $relatedCount }}
              </span>
            </div>
            {{ end }}
            {{ end }}
          </div>

          <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ -->
          <div class="p-5 space-y-3">
            
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            {{ with .Params.filters }}
            <div class="flex flex-wrap gap-1.5">
              {{ range first 3 . }}
              <span class="badge badge-ghost badge-sm">{{ . | humanize }}</span>
              {{ end }}
              {{ if gt (len .) 3 }}
              <span class="badge badge-ghost badge-sm">+{{ sub (len .) 3 }}</span>
              {{ end }}
            </div>
            {{ end }}
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <h2 class="text-xl font-bold line-clamp-2 group-hover:text-primary transition-colors">
              {{ .Title }}
            </h2>

            <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
            {{ with .Summary }}
            <p class="text-sm text-base-content/70 line-clamp-2">
              {{ . | plainify | truncate 100 }}
            </p>
            {{ end }}
            
            <!-- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (tools) -->
            {{ with .Params.tools }}
            <div class="flex flex-wrap gap-1.5">
              {{ range first 4 . }}
              <span class="inline-flex items-center gap-1 px-2 py-1 text-xs bg-base-200 rounded-md">
                <ion-icon name="code-slash-outline" class="text-xs"></ion-icon>
                {{ . }}
              </span>
              {{ end }}
              {{ if gt (len .) 4 }}
              <span class="inline-flex items-center px-2 py-1 text-xs bg-base-200 rounded-md text-base-content/60">
                +{{ sub (len .) 4 }}
              </span>
              {{ end }}
            </div>
            {{ end }}

            <!-- –§—É—Ç–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ -->
            <div class="flex items-center justify-between pt-3 border-t border-base-200">
              
              <!-- –î–∞—Ç–∞ -->
              <div class="flex items-center gap-1.5 text-xs text-base-content/60">
                <ion-icon name="calendar-outline" class="text-sm"></ion-icon>
                {{ if site.Params.Experimental.jsDate }}
                  <span data-format="luxon">{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}</span>
                {{ else }}
                  {{ .Date | time.Format ":date_medium" }}
                {{ end }}
              </div>

              <!-- –í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è -->
              <div class="flex items-center gap-1.5 text-xs text-base-content/60">
                <ion-icon name="time-outline" class="text-sm"></ion-icon>
                <span>{{ .ReadingTime }} {{ i18n "minuteRead" .ReadingTime | default "–º–∏–Ω" }}</span>
              </div>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="pt-2">
              <span class="inline-flex items-center gap-2 text-sm font-medium text-primary group-hover:gap-3 transition-all">
                {{ i18n "portfolio.viewProject" | default "–°–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–µ–∫—Ç" }}
                <ion-icon name="arrow-forward" class="text-base"></ion-icon>
              </span>
            </div>
          </div>
        </a>
        
      </div>
      {{ end }}
    </div>
    
    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <div id="portfolio-no-results" class="hidden py-20 text-center">
      <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-base-200 mb-6">
        <ion-icon name="search-outline" class="text-4xl text-base-content/30"></ion-icon>
      </div>
      <h3 class="text-xl font-bold mb-2">{{ i18n "portfolio.noProjects" | default "–ü—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ" }}</h3>
      <p class="text-base-content/60 mb-6">{{ i18n "portfolio.tryOtherFilter" | default "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é" }}</p>
      <button id="show-all-btn" class="btn btn-primary btn-sm gap-2">
        <ion-icon name="apps-outline"></ion-icon>
        {{ i18n "portfolio.resetFilter" | default "–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ" }}
      </button>
    </div>
    
    {{ end }}
    
  </div>
</section>

<!-- –°–µ–∫—Ü–∏—è "–ö–∞–∫ —è —Ä–∞–±–æ—Ç–∞—é" -->
<section class="py-12 sm:py-16 lg:py-20">
  <div class="max-w-3xl mx-auto px-4 sm:px-6">
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="text-center mb-8">
      <span class="inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-medium mb-4">
        {{ i18n "process.badge" | default "–ü—Ä–æ—Ü–µ—Å—Å" }}
      </span>
      <h2 class="text-2xl sm:text-3xl font-bold">{{ i18n "process.title" | default "–ö–∞–∫ —è —Ä–∞–±–æ—Ç–∞—é" }}</h2>
      <p class="text-base-content/60 mt-2">{{ i18n "process.subtitle" | default "4 —ç—Ç–∞–ø–∞ ‚Üí –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç" }}</p>
      <div class="flex items-center justify-center gap-2 text-sm text-base-content/50 mt-3">
        <ion-icon name="time-outline"></ion-icon>
        <span>{{ i18n "process.duration" | default "–û–±—ã—á–Ω–æ 4-10 –Ω–µ–¥–µ–ª—å" }}</span>
      </div>
    </div>
    
    <!-- Accordion -->
    <div class="space-y-3">
      
      <!-- –≠—Ç–∞–ø 1 -->
      <div class="group rounded-xl border border-base-200 dark:border-base-content/10
                  bg-base-100 dark:bg-base-200/30
                  overflow-hidden transition-all
                  hover:border-primary/30 hover:shadow-md">
        <details class="group/details">
          <summary class="flex items-center gap-4 p-4 sm:p-5 cursor-pointer
                         select-none list-none
                         [&::-webkit-details-marker]:hidden">
            
            <span class="flex items-center justify-center shrink-0
                        w-10 h-10 rounded-xl
                        bg-primary text-primary-content font-bold
                        transition-transform">
              1
            </span>
            
            <div class="flex-1 min-w-0">
              <h3 class="font-semibold group-hover:text-primary transition-colors">
                {{ i18n "process.step1.title" | default "–û–±—Å—É–∂–¥–µ–Ω–∏–µ" }}
              </h3>
              <p class="text-sm text-base-content/50 truncate">
                {{ i18n "process.step1.subtitle" | default "–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∏ –æ—Ü–µ–Ω–∫–∞" }}
              </p>
            </div>
            
            <span class="hidden sm:flex items-center gap-1 text-xs text-base-content/40 shrink-0">
              <ion-icon name="time-outline"></ion-icon>
              {{ i18n "process.step1.duration" | default "1-2 –¥–Ω—è" }}
            </span>
            
            <ion-icon name="chevron-down" 
                      class="text-xl text-base-content/30 shrink-0
                             group-open/details:rotate-180 transition-transform duration-200">
            </ion-icon>
          </summary>
          
          <div class="px-4 sm:px-5 pb-5 pt-0 ml-14">
            <div class="pt-4 border-t border-base-200 dark:border-base-content/10">
              <ul class="space-y-2 text-sm text-base-content/70">
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-primary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step1.item1" | default "–ü–µ—Ä–µ–ø–∏—Å–∫–∞ –≤ Telegram –∏–ª–∏ Email" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-primary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step1.item2" | default "–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±—Ä–∏—Ñ–∞ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-primary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step1.item3" | default "–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å—Ä–æ–∫–æ–≤ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏" }}
                </li>
              </ul>
              
              <div class="mt-4 flex items-center gap-4">
                <span class="text-xs px-2 py-1 rounded bg-primary/10 text-primary">
                  {{ i18n "process.step1.badge" | default "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }}
                </span>
                <span class="text-xs text-base-content/40">
                  {{ i18n "process.step1.note" | default "–ë–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤" }}
                </span>
              </div>
            </div>
          </div>
        </details>
      </div>
      
      <!-- –≠—Ç–∞–ø 2 -->
      <div class="group rounded-xl border border-base-200 dark:border-base-content/10
                  bg-base-100 dark:bg-base-200/30
                  overflow-hidden transition-all
                  hover:border-secondary/30 hover:shadow-md">
        <details class="group/details">
          <summary class="flex items-center gap-4 p-4 sm:p-5 cursor-pointer
                         select-none list-none
                         [&::-webkit-details-marker]:hidden">
            
            <span class="flex items-center justify-center shrink-0
                        w-10 h-10 rounded-xl
                        bg-secondary text-secondary-content font-bold">
              2
            </span>
            
            <div class="flex-1 min-w-0">
              <h3 class="font-semibold group-hover:text-secondary transition-colors">
                {{ i18n "process.step2.title" | default "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" }}
              </h3>
              <p class="text-sm text-base-content/50 truncate">
                {{ i18n "process.step2.subtitle" | default "–ü—Ä–æ—Ç–æ—Ç–∏–ø, –¢–ó –∏ –¥–æ–≥–æ–≤–æ—Ä" }}
              </p>
            </div>
            
            <span class="hidden sm:flex items-center gap-1 text-xs text-base-content/40 shrink-0">
              <ion-icon name="time-outline"></ion-icon>
              {{ i18n "process.step2.duration" | default "3-7 –¥–Ω–µ–π" }}
            </span>
            
            <ion-icon name="chevron-down" 
                      class="text-xl text-base-content/30 shrink-0
                             group-open/details:rotate-180 transition-transform duration-200">
            </ion-icon>
          </summary>
          
          <div class="px-4 sm:px-5 pb-5 pt-0 ml-14">
            <div class="pt-4 border-t border-base-200 dark:border-base-content/10">
              <ul class="space-y-2 text-sm text-base-content/70">
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-secondary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step2.item1" | default "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –≤ Figma" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-secondary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step2.item2" | default "–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-secondary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step2.item3" | default "–¢–æ—á–Ω—ã–µ —Å—Ä–æ–∫–∏ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-secondary mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step2.item4" | default "–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞" }}
                </li>
              </ul>
              
              <div class="mt-4 flex items-center gap-4">
                <span class="text-xs px-2 py-1 rounded bg-secondary/10 text-secondary">
                  {{ i18n "process.step2.badge" | default "–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 30%" }}
                </span>
              </div>
            </div>
          </div>
        </details>
      </div>
      
      <!-- –≠—Ç–∞–ø 3 -->
      <div class="group rounded-xl border border-base-200 dark:border-base-content/10
                  bg-base-100 dark:bg-base-200/30
                  overflow-hidden transition-all
                  hover:border-accent/30 hover:shadow-md">
        <details class="group/details">
          <summary class="flex items-center gap-4 p-4 sm:p-5 cursor-pointer
                         select-none list-none
                         [&::-webkit-details-marker]:hidden">
            
            <span class="flex items-center justify-center shrink-0
                        w-10 h-10 rounded-xl
                        bg-accent text-accent-content font-bold">
              3
            </span>
            
            <div class="flex-1 min-w-0">
              <h3 class="font-semibold group-hover:text-accent transition-colors">
                {{ i18n "process.step3.title" | default "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞" }}
              </h3>
              <p class="text-sm text-base-content/50 truncate">
                {{ i18n "process.step3.subtitle" | default "–°–ø—Ä–∏–Ω—Ç—ã —Å –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–º–∏ –¥–µ–º–æ" }}
              </p>
            </div>
            
            <span class="hidden sm:flex items-center gap-1 text-xs text-base-content/40 shrink-0">
              <ion-icon name="time-outline"></ion-icon>
              {{ i18n "process.step3.duration" | default "2-8 –Ω–µ–¥–µ–ª—å" }}
            </span>
            
            <ion-icon name="chevron-down" 
                      class="text-xl text-base-content/30 shrink-0
                             group-open/details:rotate-180 transition-transform duration-200">
            </ion-icon>
          </summary>
          
          <div class="px-4 sm:px-5 pb-5 pt-0 ml-14">
            <div class="pt-4 border-t border-base-200 dark:border-base-content/10">
              <ul class="space-y-2 text-sm text-base-content/70">
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-accent mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step3.item1" | default "–†–∞–±–æ—Ç–∞ —Å–ø—Ä–∏–Ω—Ç–∞–º–∏ –ø–æ 1-2 –Ω–µ–¥–µ–ª–∏" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-accent mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step3.item2" | default "–î–µ–º–æ-–≤–µ—Ä—Å–∏—è –∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-accent mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step3.item3" | default "–î–æ—Å—Ç—É–ø –∫ dev-–≤–µ—Ä—Å–∏–∏ 24/7" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-accent mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step3.item4" | default "–°–≤—è–∑—å –≤ Telegram/Slack" }}
                </li>
              </ul>
              
              <div class="mt-4 flex items-center gap-4">
                <span class="text-xs px-2 py-1 rounded bg-accent/10 text-accent">
                  {{ i18n "process.step3.badge" | default "–û–ø–ª–∞—Ç–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–ø—Ä–∏–Ω—Ç–∞" }}
                </span>
              </div>
            </div>
          </div>
        </details>
      </div>
      
      <!-- –≠—Ç–∞–ø 4 -->
      <div class="group rounded-xl border-2 border-success/30
                  bg-success/5 dark:bg-success/10
                  overflow-hidden transition-all
                  hover:border-success/50 hover:shadow-md hover:shadow-success/10">
        <details class="group/details" open>
          <summary class="flex items-center gap-4 p-4 sm:p-5 cursor-pointer
                         select-none list-none
                         [&::-webkit-details-marker]:hidden">
            
            <span class="flex items-center justify-center shrink-0
                        w-10 h-10 rounded-xl
                        bg-success text-success-content font-bold">
              <ion-icon name="checkmark" class="text-lg"></ion-icon>
            </span>
            
            <div class="flex-1 min-w-0">
              <h3 class="font-semibold text-success">
                {{ i18n "process.step4.title" | default "–ó–∞–ø—É—Å–∫" }} üöÄ
              </h3>
              <p class="text-sm text-base-content/50 truncate">
                {{ i18n "process.step4.subtitle" | default "–î–µ–ø–ª–æ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞" }}
              </p>
            </div>
            
            <span class="hidden sm:flex items-center gap-1 text-xs text-success shrink-0 font-medium">
              <ion-icon name="shield-checkmark"></ion-icon>
              {{ i18n "process.step4.guarantee" | default "–ì–∞—Ä–∞–Ω—Ç–∏—è" }}
            </span>
            
            <ion-icon name="chevron-down" 
                      class="text-xl text-success/50 shrink-0
                             group-open/details:rotate-180 transition-transform duration-200">
            </ion-icon>
          </summary>
          
          <div class="px-4 sm:px-5 pb-5 pt-0 ml-14">
            <div class="pt-4 border-t border-success/20">
              <ul class="space-y-2 text-sm text-base-content/70">
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-success mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step4.item1" | default "–î–µ–ø–ª–æ–π –Ω–∞ –≤–∞—à —Ö–æ—Å—Ç–∏–Ω–≥" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-success mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step4.item2" | default "–ü–µ—Ä–µ–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-success mt-0.5 shrink-0"></ion-icon>
                  {{ i18n "process.step4.item3" | default "–û–±—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–µ —Å —Å–∏—Å—Ç–µ–º–æ–π" }}
                </li>
                <li class="flex items-start gap-2">
                  <ion-icon name="checkmark-circle" class="text-success mt-0.5 shrink-0"></ion-icon>
                  <strong>{{ i18n "process.step4.item4" | default "30 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏" }}</strong>
                </li>
              </ul>
              
              <div class="mt-4 p-3 rounded-lg bg-success/10 border border-success/20">
                <p class="text-xs text-success font-medium">
                  ‚ú® {{ i18n "process.step4.bonus" | default "–ë–æ–Ω—É—Å: –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞" }}
                </p>
              </div>
            </div>
          </div>
        </details>
      </div>
      
    </div>
    
    <!-- CTA –∫–Ω–æ–ø–∫–∞ -->
    <div class="mt-8 text-center">
      {{- $contactLink := "https://t.me/cyber_way" -}}
      {{- $useTelegram := true -}}
      {{- $contactText := i18n "process.cta" | default "–û–±—Å—É–¥–∏—Ç—å –ø—Ä–æ–µ–∫—Ç" -}}
      
      {{ with site.GetPage "/contact" }}
        {{- $contactLink = .RelPermalink -}}
        {{- $useTelegram = false -}}
      {{ else }}
        {{ with site.Params.contact }}
          {{- $contactLink = . -}}
          {{ if strings.Contains . "t.me" }}
            {{- $useTelegram = true -}}
          {{ else }}
            {{- $useTelegram = false -}}
          {{ end }}
        {{ end }}
      {{ end }}
      
      <a href="{{ $contactLink }}" 
         class="btn btn-primary btn-lg gap-2 shadow-lg shadow-primary/25 
                hover:shadow-xl hover:shadow-primary/30 hover:-translate-y-0.5
                transition-all duration-200"
         {{ if not (hasPrefix $contactLink "/") }}target="_blank" rel="noopener"{{ end }}>
        {{ if $useTelegram }}
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
            <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
          </svg>
        {{ else }}
          <ion-icon name="chatbubbles-outline" class="text-xl"></ion-icon>
        {{ end }}
        {{ $contactText }}
        <ion-icon name="arrow-forward-outline" class="text-lg"></ion-icon>
      </a>
      
      <p class="text-sm text-base-content/50 mt-3">
        {{ i18n "process.ctaNote" | default "–ü–µ—Ä–≤–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ" }}
      </p>
    </div>
    
  </div>
</section>

<!-- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ -->
{{ if gt (len $uniqueTools) 0 }}
<section class="py-10 sm:py-12 border-t border-base-300">
  <div class="max-w-4xl mx-auto px-4 sm:px-6">
    
    <div class="text-center mb-6">
      <h2 class="text-xl sm:text-2xl font-bold mb-2">
        {{ i18n "portfolio.techTitle" | default "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏" }}
      </h2>
      <p class="text-sm text-base-content/60">
        {{ i18n "portfolio.techDescription" | default "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —è –∏—Å–ø–æ–ª—å–∑—É—é –≤ —Ä–∞–±–æ—Ç–µ" }}
      </p>
    </div>

    <div class="flex flex-wrap justify-center gap-2">
      {{ range $uniqueTools }}
      <span class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-base-200 hover:bg-primary hover:text-primary-content transition-all duration-300 cursor-default">
        {{ . }}
      </span>
      {{ end }}
    </div>
    
  </div>
</section>
{{ end }}

<!-- Isotope JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js"></script>
<script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
<script>
(function() {
  'use strict';
  
  var grid = document.getElementById('portfolio-grid');
  if (!grid) return;
  
  var noResults = document.getElementById('portfolio-no-results');
  var showAllBtn = document.getElementById('show-all-btn');
  var iso = null;
  
  // –°–∫—Ä–æ–ª–ª —Ñ–∏–ª—å—Ç—Ä–æ–≤
  var filtersScroll = document.getElementById('filters-scroll');
  var scrollLeftBtn = document.getElementById('scroll-left');
  var scrollRightBtn = document.getElementById('scroll-right');
  var fadeLeft = document.getElementById('fade-left');
  var fadeRight = document.getElementById('fade-right');
  
  function updateScrollButtons() {
    if (!filtersScroll || !scrollLeftBtn || !scrollRightBtn) return;
    
    var scrollLeft = filtersScroll.scrollLeft;
    var maxScroll = filtersScroll.scrollWidth - filtersScroll.clientWidth;
    
    scrollLeftBtn.disabled = scrollLeft <= 0;
    scrollRightBtn.disabled = scrollLeft >= maxScroll - 1;
    
    if (fadeLeft) fadeLeft.style.opacity = scrollLeft > 0 ? '1' : '0';
    if (fadeRight) fadeRight.style.opacity = scrollLeft < maxScroll - 1 ? '1' : '0';
  }
  
  if (scrollLeftBtn && filtersScroll) {
    scrollLeftBtn.addEventListener('click', function() {
      filtersScroll.scrollBy({ left: -200, behavior: 'smooth' });
    });
  }
  
  if (scrollRightBtn && filtersScroll) {
    scrollRightBtn.addEventListener('click', function() {
      filtersScroll.scrollBy({ left: 200, behavior: 'smooth' });
    });
  }
  
  if (filtersScroll) {
    filtersScroll.addEventListener('scroll', updateScrollButtons);
    window.addEventListener('resize', updateScrollButtons);
    setTimeout(updateScrollButtons, 100);
  }
  
  function initIsotope() {
    if (iso) return;
    
    try {
      iso = new Isotope(grid, {
        itemSelector: '.portfolio-item',
        layoutMode: 'fitRows',
        transitionDuration: '0.4s',
        stagger: 30,
        percentPosition: true,
        fitRows: {
          gutter: 0
        }
      });
      
      grid.classList.add('is-loaded');
      
      var filterButtons = document.querySelectorAll('.portfolio-filter-btn');
      
      filterButtons.forEach(function(button) {
        button.addEventListener('click', function() {
          var filterValue = this.getAttribute('data-filter');
          
          if (iso) {
            iso.arrange({ filter: filterValue });
          }

          filterButtons.forEach(function(btn) {
            btn.setAttribute('data-state', 'unchecked');
          });
          this.setAttribute('data-state', 'checked');
          
          // –°–∫—Ä–æ–ª–ª –∫ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–µ
          if (filtersScroll) {
            var btnRect = this.getBoundingClientRect();
            var containerRect = filtersScroll.getBoundingClientRect();
            if (btnRect.left < containerRect.left || btnRect.right > containerRect.right) {
              this.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
            }
          }
        });
      });
      
      iso.on('arrangeComplete', function(filteredItems) {
        if (noResults) {
          if (filteredItems.length === 0) {
            noResults.classList.remove('hidden');
            grid.style.display = 'none';
          } else {
            noResults.classList.add('hidden');
            grid.style.display = '';
          }
        }
      });
      
      if (showAllBtn) {
        showAllBtn.addEventListener('click', function() {
          var allBtn = document.querySelector('.portfolio-filter-btn[data-filter="*"]');
          if (allBtn) allBtn.click();
        });
      }
      
    } catch (e) {
      console.error('Portfolio Isotope init error:', e);
    }
  }
  
  function relayout() {
    if (iso) {
      try { iso.layout(); } catch (e) {}
    }
  }
  
  function startInit() {
    if (typeof imagesLoaded === 'undefined') {
      setTimeout(startInit, 100);
      return;
    }
    
    imagesLoaded(grid, function() {
      setTimeout(function() {
        initIsotope();
        setTimeout(relayout, 100);
        setTimeout(relayout, 300);
      }, 50);
    });
  }
  
  if (document.readyState === 'complete') {
    startInit();
  } else {
    window.addEventListener('load', startInit);
  }
  
  if ('fonts' in document) {
    document.fonts.ready.then(function() {
      setTimeout(relayout, 50);
    });
  }
  
  var resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(relayout, 250);
  });
  
})();
</script>

<style>
.portfolio-grid {
  display: flex;
  flex-wrap: wrap;
  opacity: 0;
  transition: opacity 0.3s ease;
}
.portfolio-grid.is-loaded {
  opacity: 1;
}
.portfolio-item {
  box-sizing: border-box;
}
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}
</style>

{{ else }}

<!-- –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ -->
<div class="min-h-[60vh] flex items-center justify-center px-4 sm:px-6">
  <div class="text-center py-12">
    <ion-icon name="briefcase-outline" class="text-5xl text-base-content/30 mb-4"></ion-icon>
    <h1 class="text-xl font-bold mb-2">{{ i18n "portfolio.title" | default "–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ" }}</h1>
    <p class="text-base-content/60 mb-6">{{ i18n "portfolio.disabled" | default "–†–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è" }}</p>
    <a href="{{ "/" | relURL }}" class="btn btn-primary btn-sm">
      {{ i18n "backToHome" | default "–ù–∞ –≥–ª–∞–≤–Ω—É—é" }}
    </a>
  </div>
</div>

{{ end }}

{{ end }}

{{ define "js" }}
{{ if site.Params.Experimental.jsDate }}
  {{ partial "luxon.html" . }}
{{ end }}
{{ end }}